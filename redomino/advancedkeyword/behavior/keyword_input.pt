<tal:block define="
    items view/items;
    fieldName view/name;
    allowedKeywords view/terms;
    site_props context/portal_properties/site_properties|nothing;
    allowRolesToAddKeywords site_props/allowRolesToAddKeywords|nothing;
    keywordswidgetgenerator view/generator;
    "
><div tal:condition="allowedKeywords" id="advancedExistingTagsSection">


<div class="subjectTree" tal:define="tree keywordswidgetgenerator">
    <metal:use-macro use-macro="context/@@keywordsmacros/keywordswidgetmacro"/>
</div>

<select id="" name="" class="" tabindex="" disabled="" multiple="" size=""
        tal:attributes="id view/id;
                        name string:${view/name}:list;
                        class view/klass;
                        style view/style;
                        title view/title;
                        lang view/lang;
                        onclick view/onclick;
                        ondblclick view/ondblclick;
                        onmousedown view/onmousedown;
                        onmouseup view/onmouseup;
                        onmouseover view/onmouseover;
                        onmousemove view/onmousemove;
                        onmouseout view/onmouseout;
                        onkeypress view/onkeypress;
                        onkeydown view/onkeydown;
                        onkeyup view/onkeyup;
                        disabled view/disabled;
                        tabindex view/tabindex;
                        onfocus view/onfocus;
                        onblur view/onblur;
                        onchange view/onchange;
                        multiple view/multiple;
                        size view/size">

    <tal:block repeat="item items">
        <option id="" value="" selected="selected"
            tal:condition="item/selected"
            tal:attributes="id item/id;
                            value item/value"
            tal:content="item/content">label</option>

        <option id="" value=""
            tal:condition="not:item/selected"
            tal:attributes="id item/id;
                            value item/value"
            tal:content="item/content">label</option>
    </tal:block>
</select>

</div>
<tal:condition define="show_new_kw view/show_new_kw">
    <div id="advancedNewTagsSection" tal:attributes="style python:show_new_kw and ' ' or 'display: none;;'">

        <label for="subject_keywords">
            <span i18n:translate="label_create_new_tags">
                Create and apply new tags.
            </span><br />
            <span id="advancedNewTagsHelp" i18n:translate="label_newTagsHelp" class="formHelp">
                Enter one tag per line, multiple words allowed. You can create nested tag separating each tag by a dot.
            </span>
        </label>
        <textarea
            id="entered_subjects"
            name="subject:lines"
            rows="4"
            tal:attributes="id string:${view/id}_additional;
                            name string:${view/name}_additional;"
            tal:content="python:request.get('%s_additional' % view.name, '')">
            A new tag
        </textarea>
    </div>
</tal:condition>

</tal:block>